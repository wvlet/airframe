<html><head><title>Airframe: airframe-log</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Taro L. Saito" /><meta name="description" content="Lightweight Building Blocks for Scala" /><meta name="og:image" content="/airframe/img/poster.png" /><meta name="image" property="og:image" content="/airframe/img/poster.png" /><meta name="og:title" content="Airframe: airframe-log" /><meta name="title" property="og:title" content="Airframe: airframe-log" /><meta name="og:site_name" content="Airframe" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Lightweight Building Blocks for Scala" /><link rel="icon" type="image/png" href="/airframe/img/favicon.png" /><meta name="twitter:title" content="Airframe: airframe-log" /><meta name="twitter:image" content="https://wvlet.org/airframe/img/poster.png" /><meta name="twitter:description" content="Lightweight Building Blocks for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/airframe/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/airframe/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/airframe/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/airframe/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/airframe/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/airframe/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/airframe/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/airframe/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/airframe/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/airframe/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/airframe/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/airframe/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/airframe/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/airframe/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/airframe/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/airframe/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/airframe/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/airframe/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/airframe/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/airframe/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/airframe/highlight/styles/ocean.css" /><link rel="stylesheet" href="/airframe/css/pattern-style.css" /><link rel="stylesheet" href="/airframe/css/overwrite.css" /><link rel="stylesheet" href="/airframe/css/solarized-dark.css" /><script async="async">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-98364158-1' , 'auto');
ga('send', 'pageview');
      </script></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/airframe/" class="brand"><div class="brand-wrapper"><span>Airframe</span></div></a></li> <li><a href="/airframe/docs/index.html" class="">Airframe Overview</a></li> <li><a href="/airframe/docs/release-notes.html" class="">Release Notes</a></li> <li><a href="/airframe/docs/airframe.html" class="">Airframe DI</a> <ul class="sub-section"> <li><a href="/airframe/docs/airframe.html#bind" class="">Bind</a></li> <li><a href="/airframe/docs/airframe.html#design" class="">Design</a></li> <li><a href="/airframe/docs/airframe.html#session" class="">Session</a></li> <li><a href="/airframe/docs/airframe.html#life-cycle" class="">Life Cycle</a></li> <li><a href="/airframe/docs/use-cases.html" class="">Use Cases</a></li> <li><a href="/airframe/docs/bindings.html" class="">Advanced Binding Types</a></li> <li><a href="/airframe/docs/debug.html" class="">Debugging DI</a></li> <li><a href="/airframe/docs/comparison.html" class="">DI Framework Comparison</a></li> <li><a href="/airframe/docs/internals.html" class="">Airframe Internals</a></li></ul></li> <li><a href="/airframe/docs/airspec.html" class="">AirSpec Testing Framework</a></li> <li><a href="/airframe/docs/index.html" class="">Airframe Modules</a> <ul class="sub-section"> <li><a href="/airframe/docs/airframe-canvas.html" class="">airframe-canvas</a></li> <li><a href="/airframe/docs/airframe-codec.html" class="">airframe-codec</a></li> <li><a href="/airframe/docs/airframe-config.html" class="">airframe-config</a></li> <li><a href="/airframe/docs/airframe-control.html" class="">airframe-control</a></li> <li><a href="/airframe/docs/airframe-fluentd.html" class="">airframe-fluentd</a></li> <li><a href="/airframe/docs/airframe-http.html" class="">airframe-http</a></li> <li><a href="/airframe/docs/airframe-http-recorder.html" class="">airframe-http-recorder</a></li> <li><a href="/airframe/docs/airframe-jdbc.html" class="">airframe-jdbc</a></li> <li><a href="/airframe/docs/airframe-jmx.html" class="">airframe-jmx</a></li> <li><a href="/airframe/docs/airframe-json.html" class="">airframe-json</a></li> <li><a href="/airframe/docs/airframe-launcher.html" class="">airframe-launcher</a></li> <li><a href="/airframe/docs/airframe-log.html" class=" active ">airframe-log</a></li> <li><a href="/airframe/docs/airframe-metrics.html" class="">airframe-metrics</a></li> <li><a href="/airframe/docs/airframe-msgpack.html" class="">airframe-msgpack</a></li> <li><a href="/airframe/docs/airframe-scalatest.html" class="">airframe-scalatest</a></li> <li><a href="/airframe/docs/airframe-surface.html" class="">airframe-surface</a></li> <li><a href="/airframe/docs/airframe-sql.html" class="">airframe-sql</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/wvlet/airframe" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/wvlet/airframe" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('Airframe Lightweight Building Blocks for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('Airframe Lightweight Building Blocks for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="wvlet" data-github-repo="airframe"><div class="content-wrapper"><section><h1 id="airframe-log--">airframe-log <a href="https://index.scala-lang.org/wvlet/airframe"><img src="https://index.scala-lang.org/wvlet/airframe/latest.svg?color=orange" alt="Latest version" /></a> <a href="https://www.scala-js.org"><img src="https://www.scala-js.org/assets/badges/scalajs-0.6.17.svg" alt="Scala.js" /></a></h1>

<p><em>airframe-log</em> is a library for enhancing your Scala application logging with colors and source code locations. Here are examples of pre-defined LogFormatters in airframe-log:</p>

<p><img src="https://wvlet.org/airframe/img/airframe-log/formatters.png" alt="image" /></p>

<p><a href="https://www.scala-js.org/">Scala.js</a> is also supported:</p>

<p><img src="https://wvlet.org/airframe/img/airframe-log/scalajs-formatters.png" alt="image" /></p>

<h2 id="usage">Usage</h2>

<p><a href="https://maven-badges.herokuapp.com/maven-central/org.wvlet.airframe/airframe-log_2.12/"><img src="https://maven-badges.herokuapp.com/maven-central/org.wvlet.airframe/airframe-log_2.12/badge.svg" alt="Maven Central" /></a></p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"org.wvlet.airframe"</span> <span class="o">%%</span> <span class="s">"airframe-log"</span> <span class="o">%</span> <span class="s">"(version)"</span>

<span class="c1">// For Scala.js (Since airframe-log 1.2)
</span><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"org.wvlet.airframe"</span> <span class="o">%%%</span> <span class="s">"airframe-log"</span> <span class="o">%</span> <span class="s">"(version)"</span>
</code></pre></div></div>

<h2 id="features">Features</h2>
<ul>
  <li><strong>Simple to use</strong>
    <ul>
      <li>You can start logging by adding <code class="highlighter-rouge">wvlet.log.LogSupport</code> trait to your code. No need to write <code class="highlighter-rouge">Logger.getLogger(xxx)</code> anymore.</li>
    </ul>
  </li>
  <li><strong>Fast and light-weight</strong>
    <ul>
      <li>airframe-log uses Scala macros for efficiency; log messages will be instantiated only when the log level is effective.</li>
      <li>airframe-log is just an extension of JVM’s built-in <code class="highlighter-rouge">java.util.logging</code>. So no need exists to add custom binding jars, such as logback-classic as in slf4j.</li>
    </ul>
  </li>
  <li><strong>Informative</strong>
    <ul>
      <li>ANSI colored logging support.</li>
      <li>You can also show the <strong>source code locations</strong> (line number and pos) of log messages.</li>
    </ul>
  </li>
  <li><strong>Fully customizable</strong>
    <ul>
      <li>log levels can be changed at ease with the periodic log-level scanner.</li>
      <li>You can also change the log level through the standard JMX interface for <code class="highlighter-rouge">java.util.logging</code>.</li>
      <li>Easy to customize your own log format and log levels <em>inside</em> the code. No external XML configuration is required.</li>
    </ul>
  </li>
  <li><strong>Production ready</strong>
    <ul>
      <li>airframe-log has built-in handlers for log file rotations, asynchronous logging.</li>
      <li>Scala 2.12, 2.13, Scala.js support</li>
    </ul>
  </li>
</ul>

<h2 id="resources">Resources</h2>
<ul>
  <li>GitHub: <a href="https://github.com/wvlet/airframe/tree/master/airframe-log">airframe-log</a></li>
  <li>Blog post: <a href="https://medium.com/@taroleo/airframe-log-a-modern-logging-library-for-scala-56fbc2f950bc">Airframe Log: A Modern Logging Library for Scala</a></li>
</ul>

<h3 id="using-logsupport-trait">Using LogSupport trait</h3>

<p>The most convenient way to use airframe-log is adding <code class="highlighter-rouge">LogSupport</code> to your class:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.log.LogSupport</span>

<span class="k">object</span> <span class="nc">MyApp</span> <span class="k">extends</span> <span class="nc">LogSupport</span>  <span class="o">{</span>
   <span class="nf">info</span><span class="o">(</span><span class="s">"info log"</span><span class="o">)</span>
   <span class="nf">debug</span><span class="o">(</span><span class="s">"debug log"</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The logger name will be determined from your class name (e.g., <code class="highlighter-rouge">MyApp</code>).</p>

<p>Alternatively you can load <code class="highlighter-rouge">Logger</code> instance manually:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.log.Logger</span>

<span class="k">class</span> <span class="nc">YourApp</span> <span class="o">{</span>
   <span class="k">private</span> <span class="k">val</span> <span class="nv">logger</span> <span class="k">=</span> <span class="nv">Logger</span><span class="o">.</span><span class="py">of</span><span class="o">[</span><span class="kt">YourApp</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="using-the-default-configuration">Using the default configuration</h3>

<p>If your project involves dependencies that set their own java.util.logging configurations, 
you can force using the default configuration of Airframe Log by calling <code class="highlighter-rouge">wvlet.airframe.log.init</code>:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.airframe._</span>

<span class="c1">// Initialize with INFO level and SourceCodeLogFormatter
</span><span class="nv">log</span><span class="o">.</span><span class="py">init</span>

<span class="c1">// For terminals not supporting ANSI colors
</span><span class="nv">log</span><span class="o">.</span><span class="py">initNoColor</span>
</code></pre></div></div>

<h3 id="configuring-log-levels">Configuring log levels</h3>

<p>(This feature is not available in Scala.js)</p>

<p>If <code class="highlighter-rouge">Logger.scheduleLogLevelScan</code> is called, airframe-log periodically scans log-level properties file (default every 1 minute) to configure logger levels:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.log.Logger</span>

<span class="o">#</span><span class="k">#</span> <span class="nc">Scan</span> <span class="n">log</span> <span class="nf">files</span> <span class="o">(</span><span class="n">not</span> <span class="n">available</span> <span class="k">for</span> <span class="nv">Scala</span><span class="o">.</span><span class="py">js</span><span class="o">)</span>
<span class="nv">Logger</span><span class="o">.</span><span class="py">scheduleLogLevelScan</span>
</code></pre></div></div>

<p><strong><em>log.properties</em></strong> example:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># You can use all, trace, debug, info, warn, error, info, all as log level
wvlet.airframe=debug
org.eclipse.jetty=info
org.apache.http=info
com.amazonaws=info
</code></pre></div></div>
<p>The format follows <a href="https://docs.oracle.com/javase/7/docs/api/java/util/Properties.html#load(java.io.Reader)">Java Properties file format</a>.</p>

<p>In default, loglevel file will be found in this order:</p>

<ol>
  <li><code class="highlighter-rouge">log-test.properties</code> in the classpath.</li>
  <li>If 1. is not found, use <code class="highlighter-rouge">log.properties</code> in the classpath.</li>
</ol>

<p>To change the log file path, you can use <code class="highlighter-rouge">Logger.scheduleLogLevelScan(file paths, duration)</code>.</p>

<p>In debugging your application, create <code class="highlighter-rouge">src/test/resources/log-test.properties</code> file, and
call <code class="highlighter-rouge">Logger.scheduleLogLevelScan</code> before running test cases. This is useful for quickly checking the log messages.</p>

<h3 id="using-loglevelscanner-with-scalatest">Using LoglevelScanner with ScalaTest</h3>

<p>To scan log level properties periodically with <a href="http://www.scalatest.org/">ScalaTest</a>, define the base trait as follows:</p>

<p><strong><a href="https://github.com/wvlet/log/blob/master/src/test/scala/wvlet/log/Spec.scala">Spec.scala</a></strong></p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">org.scalatest.</span><span class="o">{</span><span class="nc">BeforeAndAfter</span><span class="o">,</span> <span class="nc">BeforeAndAfterAll</span><span class="o">,</span> <span class="nc">WordSpec</span><span class="o">,</span> <span class="k">_</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">wvlet.log.LogFormatter.SourceCodeLogFormatter</span>

<span class="k">trait</span> <span class="nc">Spec</span> <span class="k">extends</span> <span class="nc">WordSpec</span> <span class="k">with</span> <span class="nc">Matchers</span> <span class="k">with</span> <span class="nc">BeforeAndAfterAll</span> <span class="k">with</span> <span class="nc">LogSupport</span> <span class="o">{</span>
  <span class="c1">// Set the default log formatter
</span>  <span class="nv">Logger</span><span class="o">.</span><span class="py">setDefaultFormatter</span><span class="o">(</span><span class="nc">SourceCodeLogFormatter</span><span class="o">)</span>

  <span class="k">override</span> <span class="k">protected</span> <span class="k">def</span> <span class="nf">beforeAll</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="c1">// Run LogLevel scanner (log-test.properties or log.properties in classpath) every 1 minute
</span>    <span class="nv">Logger</span><span class="o">.</span><span class="py">scheduleLogLevelScan</span>
    <span class="nv">super</span><span class="o">.</span><span class="py">beforeAll</span><span class="o">()</span>
  <span class="o">}</span>

  <span class="k">override</span> <span class="k">protected</span> <span class="k">def</span> <span class="nf">afterAll</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span>
    <span class="nv">Logger</span><span class="o">.</span><span class="py">stopScheduledLogLevelScan</span>
    <span class="nv">super</span><span class="o">.</span><span class="py">afterAll</span><span class="o">()</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="k">class</span> <span class="nc">YourSpec</span> <span class="k">extends</span> <span class="nc">Spec</span> <span class="o">{</span>
   <span class="s">"my application"</span> <span class="n">should</span> <span class="o">{</span>
      <span class="s">"run correctly"</span> <span class="n">in</span> <span class="o">{</span>
         <span class="c1">// show a log message
</span>         <span class="nf">debug</span><span class="o">(</span><span class="s">"this is debug log"</span><span class="o">)</span>
      <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="customizing-log-format">Customizing log format</h3>

<p>You can show the source code location where the log message is generated:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.log._</span>

<span class="k">object</span> <span class="nc">MyApp</span> <span class="k">with</span> <span class="nc">LogSupport</span> <span class="o">{</span>
   <span class="nv">Logger</span><span class="o">.</span><span class="py">setDefaultFormatter</span><span class="o">(</span><span class="nv">LogFormatter</span><span class="o">.</span><span class="py">SourceCodeLogFormatter</span><span class="o">)</span>
   <span class="nf">info</span><span class="o">(</span><span class="s">"log with source code"</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>
<p>This code will show:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[MyApp$] log with source code - (MyApp.scala:6)
</code></pre></div></div>
<h3 id="pre-defined-log-formatters">Pre-defined log formatters:</h3>
<p>Here is the list of pre-defined log formatters.</p>
<ul>
  <li><strong>SourceCodeLogFormatter</strong> (with source code location)</li>
  <li><strong>PlainSourceCodeLogFormatter</strong> (with source code location without ANSI coloring)</li>
  <li><strong>AppLogFormatter</strong> (without source code location)</li>
  <li><strong>TSVLogFormatter</strong> (logging in TSV format)</li>
  <li><strong>IntelliJLogFormatter</strong> (for debugging using IntelliJ console)</li>
  <li><strong>SimpleLogFormatter</strong> (just logger name and log message)</li>
  <li><strong>BareFormatter</strong> (shows only log message)</li>
</ul>

<h3 id="customising-logformatter">Customising LogFormatter</h3>
<p>You can also define your own LogFormatter:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.log.LogFormatter._</span>
<span class="k">object</span> <span class="nc">CustomLogFormatter</span> <span class="k">extends</span> <span class="nc">LogFormatter</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">def</span> <span class="nf">formatLog</span><span class="o">(</span><span class="n">r</span><span class="k">:</span> <span class="kt">LogRecord</span><span class="o">)</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="nv">log</span> <span class="k">=</span> <span class="n">s</span><span class="s">"[${highlightLog(r.level, r.leafLoggerName)}] ${highlightLog(r.level, r.getMessage)}"</span>
    <span class="nf">appendStackTrace</span><span class="o">(</span><span class="n">log</span><span class="o">,</span> <span class="n">r</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">}</span>

<span class="nv">Logger</span><span class="o">.</span><span class="py">setDefaultFormatter</span><span class="o">(</span><span class="nc">CustomLogFormatter</span><span class="o">)</span>
</code></pre></div></div>
<p>See also the examples in <a href="https://github.com/wvlet/airframe/blob/master/airframe-log/shared/src/main/scala/wvlet/log/LogFormat.scala">LogFormat.scala</a>:</p>

<h3 id="using-airframe-log-in-scalajs">Using airframe-log in Scala.js</h3>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">wvlet.log._</span>

<span class="c1">// This configuration becomes unnecessary since 0.43
//Logger.setDefaultHandler(new JSConsoleLogHandler)
</span>  
<span class="k">class</span> <span class="nc">YourAppClass</span> <span class="k">extends</span> <span class="nc">LogSupport</span> <span class="o">{</span>

  <span class="nf">info</span><span class="o">(</span><span class="s">"hello"</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The log message will be showin in your browser’s developer console.</p>

<p>To configure the log level, use <code class="highlighter-rouge">wvlet.log.setDefaultLogLevel</code> or <code class="highlighter-rouge">wvlet.log.setLogLevel</code>:</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> <span class="nx">wvlet</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">setDefaultLogLevel</span><span class="p">(</span><span class="dl">"</span><span class="s2">debug</span><span class="dl">"</span><span class="p">)</span>

<span class="o">&gt;</span> <span class="nx">wvlet</span><span class="p">.</span><span class="nx">log</span><span class="p">.</span><span class="nx">setLogLevel</span><span class="p">(</span><span class="dl">"</span><span class="s2">your.logger.name</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">trace</span><span class="dl">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="using-with-slf4j">Using with slf4j</h3>

<p>If you are using slf4j, just add <code class="highlighter-rouge">slf4j-jdk14</code> to your dependency. The log messages from slf4j will be sent to wvlet-log:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"org.slf4j"</span> <span class="o">%</span> <span class="s">"slf4j-jdk14"</span> <span class="o">%</span> <span class="s">"1.7.21"</span>
</code></pre></div></div>

<ul>
  <li>See also the article, <a href="http://blog.seratch.net/post/150202874933/how-to-start-using-wvlet-log-with-slf4j-projects">How to start using wvlet-log with slf4j projects</a>, written by <a href="https://github.com/seratch">@seratch</a> (author of skinny-framework, scalikejdbc, etc.)</li>
</ul>

<h3 id="using-with-log4j">Using with log4j</h3>

<p>For example, the default logger of Hadoop and Spark is log4j. You can send logs from airframe-log to log4j by adding
log4j-jul binder:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"org.apache.logging.log4j"</span> <span class="o">%</span> <span class="s">"log4j-jul"</span> <span class="o">%</span> <span class="s">"2.6.1"</span><span class="o">,</span>
</code></pre></div></div>

<h3 id="writing-and-rotating-logs-with-files">Writing and rotating logs with files</h3>

<p>To write and rotate your logs, use <code class="highlighter-rouge">LogRotationHandler</code>:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>logger.resetHandler(new LogRotationHandler(
    fileName = "your-app.log",
    maxNumberOfFiles = 100, // rotate up to 100 log files
    maxSizeInBytes = 100 * 1024 * 1024 // 100MB
    AppLogFormatter // Any log formatter you like
))
</code></pre></div></div>

<p>If you simply need to output logs to a single file without any rotation, use <code class="highlighter-rouge">FileHandler</code>:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">logger</span><span class="o">.</span><span class="py">resetHandler</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileHandler</span><span class="o">(</span>
    <span class="n">fileName</span> <span class="k">=</span> <span class="s">"your-app.log"</span><span class="o">,</span> <span class="c1">// Log file name
</span>    <span class="n">formatter</span> <span class="k">=</span> <span class="nc">AppLogFormatter</span> <span class="c1">// Any log formatter you like
</span><span class="o">))</span>
</code></pre></div></div>

<h3 id="asynchronous-logging">Asynchronous logging</h3>

<p>If you know your LogHandler is a heavy process (e.g., writing to network or slow disks), you can use 
<code class="highlighter-rouge">AsyncHandler</code> to do the logging in a background thread:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">asyncHandler</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">AsyncHandler</span><span class="o">(</span><span class="n">a</span> <span class="n">heavy</span> <span class="n">parent</span> <span class="n">log</span> <span class="n">handler</span><span class="o">)</span>
<span class="k">try</span> <span class="o">{</span>
  <span class="nv">logger</span><span class="o">.</span><span class="py">resetHandler</span><span class="o">(</span><span class="n">asyncHandler</span><span class="o">)</span>
<span class="o">}</span>   
<span class="k">finally</span> <span class="o">{</span>
  <span class="nv">asyncHandler</span><span class="o">.</span><span class="py">close</span> <span class="c1">// To flush unwritten log messages
</span><span class="o">}</span>
</code></pre></div></div>
<p>Note that however AsyncHandler has usually higher overhead than the default handler since the asynchronous process involves locking and signal calls. 
We recommend to use AsyncHandler only if you know the overhead of the log writing is considerably high. 
LogRotationHandler is already optimized for writing logs to files, so you usually don’t need to use AsyncHandler with LogRotationHandler.</p>

<h3 id="clear-existing-logger-configurations">Clear Existing Logger Configurations</h3>

<p>To remove all previous configurations of the logger (e.g., configurations set by third-party libraries), use:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">Logger</span><span class="o">.</span><span class="py">clearAllHandlers</span>

<span class="c1">// Then set your logger configurations
</span><span class="nv">Logger</span><span class="o">.</span><span class="py">setDefaultFormatter</span><span class="o">(</span><span class="nv">LogFormatter</span><span class="o">.</span><span class="py">SourceCodeLogFormatter</span><span class="o">)</span>
</code></pre></div></div>

<h3 id="changing-log-levels-using-jmx">Changing Log Levels using JMX</h3>

<p>To change the log levels outside the JVM process, you can use the JMX interface of <code class="highlighter-rouge">wvlet.log.Logger</code>.</p>

<p>For example, by using <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/management/jconsole.html">jconsole</a> you can access the JMX interface and change the log levels:
<img src="../img/airframe-log/jmx.png" alt="image" /></p>

<h2 id="internals">Internals</h2>

<h3 id="scala-macro-based-logging-code-generation">Scala macro based logging code generation</h3>

<p>airframe-log is efficient since it generate the log message objects only when necessary. 
For example, this logging code:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">debug</span><span class="o">(</span><span class="n">s</span><span class="s">"heavy debug log generation ${obj.toString}"</span><span class="o">)</span>
</code></pre></div></div>
<p>will be translated into the following efficient one with Scala macros:</p>
<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">if</span><span class="o">(</span><span class="nv">logger</span><span class="o">.</span><span class="py">isDebugEnabled</span><span class="o">)</span> <span class="o">{</span>
   <span class="nf">debug</span><span class="o">(</span><span class="n">s</span><span class="s">"heavy debug log generation ${obj.toString}"</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>
<p>Log message String generation will not happen unless the debug log is effective. 
Scala macro is also used for finding source code location (LogSource).</p>

<h3 id="to-disable-logging-at-compile-time">To disable Logging at compile-time</h3>

<p>It is possible to disable the code generation of log statements at compile time.
Add <code class="highlighter-rouge">scalacOptions += "-Xmacro-settings:wvlet.log.disable.[SUPPRESS_BELOW]"</code> compiler option to <code class="highlighter-rouge">build.sbt</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SUPPRESS_BELOW = {`ALL` ||`ERROR` || `WARN` || `INFO` || `DEBUG`}:
</code></pre></div></div>
<p>e.g. <code class="highlighter-rouge">scalacOptions += "-Xmacro-settings:wvlet.log.disable.INFO"</code> will suppress DEBUG, TRACE and INFO level log code generation.</p>

<p>Note that <code class="highlighter-rouge">ALL</code> is just an alias for <code class="highlighter-rouge">ERROR</code> which will disable all logging.</p>

<h2 id="why-it-uses-javautillogging-instead-of-slf4j">Why it uses java.util.logging instead of slf4j?</h2>

<p><em>slf4j</em> is just an API for logging string messages, so there is no way to configure the log levels and log format <em>within your program</em>. To use slf4j, you always need to include an slf4j 
binding library, such as <em>logback-classic</em>. slf4j’s logging configuration is binder-specific (e.g., slf4j-simple, logback-classic, etc.), 
and your application always need to include a dependency to one of the slf4j implementations. There is nothing wrong in it if these slf4j bindings are used properly, but 
third-party libraries often include slf4j bindings as dependencies, and cause unexpected logging behaviour.</p>

<p><code class="highlighter-rouge">java.util.logging</code> is a standard API of Java and no binding library is required, but configuring <code class="highlighter-rouge">java.util.logging</code> was still difficult and error prone (See an example in <a href="http://stackoverflow.com/questions/960099/how-to-set-up-java-logging-using-a-properties-file-java-util-logging">Stack Overflow</a>) 
 <em>airframe-log</em> makes things easier for Scala developers.</p>

<h2 id="related-projects">Related Projects</h2>

<ul>
  <li>
    <p><a href="https://github.com/typesafehub/scala-logging">scala-logging</a>: 
An wrapper of <em>slf4j</em> for Scala. This also uses Scala macros to make logging efficient. No built-in source code location format, and you still need some slf4j bindings and its configuration.</p>
  </li>
  <li>
    <p><a href="https://github.com/twitter/util#logging">twitter/util-logging</a>: This is also an wrapper of <code class="highlighter-rouge">java.util.logging</code> for Scala, but it doesn’t use Scala macros, so you need to use an old sprintf style log generation, or <code class="highlighter-rouge">ifDebug(log)</code> 
method to avoid expensive log message generation.</p>
  </li>
  <li>
    <p><a href="https://github.com/outr/scribe">scribe</a>:
A pure-scala logger implementation, which has a similar set of functionality with airframe-log (e.g., macro based code generation, programmatically configurable).
As of June 2018, scribe doesn’t support runtime log level configurations via JMX nor log.properties file.</p>
  </li>
</ul>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/airframe/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
              </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script>((window.gitter = {}).chat = {}).options = {
room: 'wvlet/airframe'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/airframe/js/main.js"></script></body></html>